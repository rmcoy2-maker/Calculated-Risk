from __future__ import annotations
import streamlit as st
from app.lib.auth import login, show_logout
# === Auth (auto-injected) ===
import streamlit as st  # ensured
from app.lib.auth import login, show_logout

auth = login(required=False)   # or required=True for protected pages
if not auth.authenticated:
    st.info("You are in read-only mode.")
show_logout()  # sidebar logout
# === /Auth (auto-injected) ===
from __future__ import annotations
import streamlit as st
# --- import bootstrap so 'app' package is importable when run from anywhere ---
import sys
from pathlib import Path
_HERE = Path(__file__).resolve()
# file: .../serving_ui/app/pages/<page>.py  -> parents[2] = .../serving_ui
_SERVING_UI = _HERE.parents[2]
if str(_SERVING_UI) not in sys.path:
    sys.path.insert(0, str(_SERVING_UI))
# -----------------------------------------------------------------------------import streamlit as st
st.set_page_config(page_title='99 Error Dashboard', page_icon='üìà', layout='wide')

import streamlit as st

import streamlit as st


import streamlit as st

import streamlit as st
# --- diagnostics import (robust) ---
try:
    from app.utils.diagnostics import mount_in_sidebar
except ModuleNotFoundError:
    try:
        import sys
        from pathlib import Path as _efP
        # add repo/serving_ui to sys.path so 'app' is importable
        sys.path.append(str(_efP(__file__).resolve().parents[3]))
        from app.utils.diagnostics import mount_in_sidebar
    except Exception:
        try:
            # fallback if pages run with CWD=app
            from utils.diagnostics import mount_in_sidebar
        except Exception:
            def mount_in_sidebar(page_name: str):
                return None
# --- /diagnostics import (robust) ---
try:
    pass
except Exception:
    pass
st.markdown("""
<style>
  .block-container { max-width: none !important; padding-left: 1rem; padding-right: 1rem; }
  [data-testid="stHeader"] { z-index: 9990; }
</style>
""", unsafe_allow_html=True)
# --- auto-added: newest-first patch ---

try:
    # Preferred absolute import (when 'app' is a proper package)
    from app.utils.newest_first_patch import apply_newest_first_patch as __nfp_apply
except Exception:
    try:
        # Fallback if pages are executed such that relative path works
        from utils.newest_first_patch import apply_newest_first_patch as __nfp_apply
    except Exception:
        # Final no-op guard
        def __nfp_apply(_): 
            return
import streamlit as st  # ensure alias available
__nfp_apply(st)
# --- end auto-added ---
try:
    from app.bootstrap import bootstrap_paths; bootstrap_paths()
except Exception:
    import sys, os
    from pathlib import Path
    _root = str(Path(__file__).resolve().parents[2])  # repo root
    if _root not in sys.path:
        sys.path.insert(0, _root)
    try:
        from app.bootstrap import bootstrap_paths; bootstrap_paths()
    except Exception:
        pass
import sys as _sys
from pathlib import Path as _Path
try:
    _ROOT = _Path(__file__).resolve().parents[2]   # .../serving_ui/app
    _REPO = _ROOT.parents[1]
    if str(_REPO) not in _sys.path:
        _sys.path.insert(0, str(_REPO))
except Exception:
    pass
# === end boot ===# --- path bootstrap: allow `import app.*` from any page ---
import sys
from pathlib import Path
_REPO_ROOT = Path(__file__).resolve().parents[2]
if str(_REPO_ROOT) not in sys.path:
    sys.path.insert(0, str(_REPO_ROOT))
from pathlib import Path
import streamlit as st
st.title("üö® Error Dashboard")

ROOT = Path(__file__).resolve().parents[2]
LOGFILE = ROOT / "exports" / "errors.log"

colA, colB = st.columns([2,1])
with colA:
    st.write("Log file:", LOGFILE)
with colB:
    if st.button("√∞≈∏¬ß¬π Clear log"):
        LOGFILE.write_text("", encoding="utf-8")
        st.success("Cleared.")
        st.rerun()

if not LOGFILE.exists() or LOGFILE.stat().st_size == 0:
    st.success("‚úÖ No errors logged yet.")
else:
    st.download_button("‚¨áÔ∏è¬è Download errors.log", LOGFILE.read_bytes(), file_name="errors.log")
    st.text_area("Errors", LOGFILE.read_text(encoding="utf-8"), height=600)
























